{
  "projectTitle": "YouTube Learning Companion App",
  "projectDescription": "YouTube動画のトランスクリプトを活用し、動画視聴、タイムスタンプ付き目次の探索、およびコンテンツに関する対話型チャットを融合させた最高の学習体験を実現するWebアプリケーション。",
  "features": [
    {
      "id": "F001",
      "name": "環境構築と初期設定",
      "description": "Next.jsプロジェクトの初期設定、依存関係のインストール、環境変数の設定、各種ツール（ESLint, Prettier）の導入。",
      "status": "pending",
      "priority": "high",
      "subFeatures": [
        {"id": "F001-01", "name": "Next.jsプロジェクトの初期化 (App Router)", "status": "pending", "priority": "high"},
        {"id": "F001-02", "name": "依存関係のインストール (React, ReactDOM, Next.js, etc.)", "status": "pending", "priority": "high"},
        {"id": "F001-03", "name": "Tailwind CSSのセットアップと設定", "status": "pending", "priority": "high"},
        {"id": "F001-04", "name": "TypeScriptの設定 (`tsconfig.json`)", "status": "pending", "priority": "high"},
        {"id": "F001-05", "name": "ESLintとPrettierの導入と設定", "status": "pending", "priority": "medium"},
        {"id": "F001-06", "name": "`.env`ファイルの作成と環境変数の設定", "status": "pending", "priority": "high"},
        {"id": "F001-07", "name": "基本ディレクトリ構造の作成 (`src/app`, `src/components`, `src/lib`, `src/types`, `src/app/api`, `docs`)", "status": "pending", "priority": "high"}
      ]
    },
    {
      "id": "F002",
      "name": "認証機能 (Google OAuth)",
      "description": "NextAuth.jsとGoogle Providerを利用したユーザー認証機能の実装。セキュリティとユーザー体験を考慮。",
      "status": "pending",
      "priority": "high",
      "docs": ["docs/authentication.md"],
      "subFeatures": [
        {"id": "F002-01", "name": "NextAuth.jsのインストールと基本設定", "status": "pending", "priority": "high"},
        {"id": "F002-02", "name": "Google OAuth Providerの設定とAPIキーの管理", "status": "pending", "priority": "high", "docs": ["docs/authentication.md"]},
        {"id": "F002-03", "name": "認証用APIルート (`src/app/api/auth/[...nextauth]/route.ts`) の作成", "status": "pending", "priority": "high"},
        {"id": "F002-04", "name": "サインイン/サインアウト機能の実装 (UIコンポーネント含む)", "status": "pending", "priority": "high"},
        {"id": "F002-05", "name": "セッション情報の取得と表示（ヘッダーなどにユーザー名/アバター）", "status": "pending", "priority": "medium"},
        {"id": "F002-06", "name": "認証済みユーザーのみアクセス可能なページの保護 (`middleware.ts` またはサーバーコンポーネント)", "status": "pending", "priority": "high"},
        {"id": "F002-07", "name": "未認証ユーザーのリダイレクト処理", "status": "pending", "priority": "medium"}
      ]
    },
    {
      "id": "F003",
      "name": "データベース設計とORM設定",
      "description": "Prismaを推奨ORMとして、必要なデータベーススキーマの定義とマイグレーション設定。",
      "status": "pending",
      "priority": "high",
      "subFeatures": [
        {"id": "F003-01", "name": "Prismaのインストールと初期設定 (`prisma init`)", "status": "pending", "priority": "high"},
        {"id": "F003-02", "name": "Prismaスキーマ定義 - Userモデル (`id`, `email`, `name`, `image`など)", "status": "pending", "priority": "high"},
        {"id": "F003-03", "name": "Prismaスキーマ定義 - Videoモデル (`id`, `youtubeId`, `title`, `description`, `thumbnailUrl`, `duration`, `userId`など)", "status": "pending", "priority": "high"},
        {"id": "F003-04", "name": "Prismaスキーマ定義 - TranscriptSegmentモデル (`id`, `videoId`, `text`, `startMs`, `endMs`など)", "status": "pending", "priority": "high"},
        {"id": "F003-05", "name": "Prismaスキーマ定義 - ChatSessionモデル (`id`, `videoId`, `userId`, `createdAt`, `updatedAt`など)", "status": "pending", "priority": "medium"},
        {"id": "F003-06", "name": "Prismaスキーマ定義 - ChatMessageモデル (`id`, `sessionId`, `role`, `content`, `timestampMs`, `createdAt`など)", "status": "pending", "priority": "medium"},
        {"id": "F003-07", "name": "初期マイグレーションの実行", "status": "pending", "priority": "high"},
        {"id": "F003-08", "name": "Prisma Clientの初期化と使用準備", "status": "pending", "priority": "high"}
      ]
    },
    {
      "id": "F004",
      "name": "YouTube動画インポート機能",
      "description": "YouTube Data API v3と字幕取得ライブラリを活用し、指定URLから動画情報とトランスクリプトをインポートしDBに保存する機能。",
      "status": "pending",
      "priority": "high",
      "docs": ["docs/import_video.md", "docs/incident_reports.md", "docs/walkthrough_20241214.md"],
      "subFeatures": [
        {"id": "F004-01", "name": "YouTube Data API v3クライアントのセットアップとAPIキーの管理", "status": "pending", "priority": "high"},
        {"id": "F004-02", "name": "動画URL入力フォームの作成 (UIコンポーネント `src/components/ImportForm.tsx`)", "status": "pending", "priority": "high"},
        {"id": "F004-03", "name": "動画情報の取得API (`GET /api/youtube/video-info?url=`) の実装", "status": "pending", "priority": "high"},
        {"id": "F004-04", "name": "YouTubeから字幕データを取得するユーティリティ関数 (`src/lib/transcript-fetcher.ts`) の開発", "status": "pending", "priority": "high", "notes": "過去のタイムスタンプ問題(2025-12-14)を考慮し、厳密なプロパティチェックとデータ正規化(JSON.parse(JSON.stringify))を必須とする。恣意的なしきい値(10秒ルール)の再導入は禁止。", "docs": ["docs/incident_reports.md", "docs/walkthrough_20241214.md"]},
        {"id": "F004-05", "name": "動画データと字幕データをDBに保存するAPI (`POST /api/videos`) の実装", "status": "pending", "priority": "high"},
        {"id": "F004-06", "name": "インポート処理中のローディング表示とエラーハンドリング", "status": "pending", "priority": "medium"},
        {"id": "F004-07", "name": "既にインポート済みの動画に対する重複チェック", "status": "pending", "priority": "medium"}
      ]
    },
    {
      "id": "F005",
      "name": "ダッシュボード機能",
      "description": "ユーザーがインポートした動画を一覧表示し、管理・操作できるダッシュボードページ。",
      "status": "pending",
      "priority": "high",
      "docs": ["docs/ui_design_guidelines.md", "docs/incident_reports.md"],
      "subFeatures": [
        {"id": "F005-01", "name": "ダッシュボードページのルーティング (`/dashboard`)", "status": "pending", "priority": "high"},
        {"id": "F005-02", "name": "ユーザーがインポートした動画一覧を取得するAPI (`GET /api/videos`) の実装", "status": "pending", "priority": "high"},
        {"id": "F005-03", "name": "動画カードコンポーネント (`src/components/VideoCard.tsx`) の作成", "status": "pending", "priority": "high", "notes": "UIデザインガイドラインに沿ってデザイン。動画タイトル、サムネイル、インポート日を表示。"},
        {"id": "F005-04", "name": "動画カードの一覧表示 (`src/app/dashboard/page.tsx` および `src/components/DashboardClient.tsx`)", "status": "pending", "priority": "high"},
        {"id": "F005-05", "name": "動画詳細ページへの遷移リンク (動画カードから `/learn/[videoId]`)", "status": "pending", "priority": "high", "notes": "過去のイベント競合問題(2025-12-14)を考慮し、`<Link>`でカード全体をラップせず、`div` + `onClick`でルーティング、または削除ボタンと明確に分離する構造を推奨。", "docs": ["docs/incident_reports.md"]},
        {"id": "F005-06", "name": "動画削除ボタンの追加と機能実装", "status": "pending", "priority": "high", "notes": "過去の削除機能問題(2025-12-14)を考慮。`DELETE /api/videos/[id]`エンドポイントを実装。`window.confirm`ではなく、即時削除またはカスタムモーダルUIでの確認を検討。イベント伝播の停止を確実に行う。", "docs": ["docs/incident_reports.md"]},
        {"id": "F005-07", "name": "動画検索/フィルタリング機能 (オプション)", "status": "pending", "priority": "low"},
        {"id": "F005-08", "name": "ページネーションまたは無限スクロール (オプション)", "status": "pending", "priority": "low"}
      ]
    },
    {
      "id": "F006",
      "name": "学習ページ (動画視聴・トランスクリプト・チャット)",
      "description": "動画プレーヤー、同期トランスクリプト、タイムスタンプ付き目次、対話型チャットを融合した学習体験を提供するコアページ。",
      "status": "pending",
      "priority": "high",
      "docs": ["docs/ui_design_guidelines.md", "docs/incident_reports.md", "docs/walkthrough_20241214.md"],
      "subFeatures": [
        {"id": "F006-01", "name": "学習ページのルーティング (`/learn/[videoId]`)", "status": "pending", "priority": "high"},
        {"id": "F006-02", "name": "動画情報と字幕データを取得するAPI (`GET /api/videos/[id]`, `GET /api/transcripts/[videoId]`) の実装", "status": "pending", "priority": "high"},
        {"id": "F006-03", "name": "YouTube動画プレーヤーの埋め込み (ReactPlayerなどのライブラリを検討)", "status": "pending", "priority": "high"},
        {"id": "F006-04", "name": "トランスクリプト表示コンポーネントの作成", "status": "pending", "priority": "high", "notes": "字幕テキストとタイムスタンプ (`startMs`, `endMs`) を表示。過去のタイムスタンプ問題(2025-12-14)を考慮し、正確な表示を保証。", "docs": ["docs/incident_reports.md", "docs/walkthrough_20241214.md"]},
        {"id": "F006-05", "name": "動画再生位置とトランスクリプトのリアルタイム同期ハイライト", "status": "pending", "priority": "high"},
        {"id": "F006-06", "name": "トランスクリプト上のテキストクリックで動画の該当位置へシーク機能", "status": "pending", "priority": "high"},
        {"id": "F006-07", "name": "タイムスタンプ付き目次 (チャプター) 生成・表示機能 (トランスクリプトから自動生成)", "status": "pending", "priority": "medium", "notes": "長い動画の場合、主要なトピックを抽出して目次とする。"},
        {"id": "F006-08", "name": "対話型チャットUIコンポーネントの作成 (入力フォーム、メッセージ表示エリア)", "status": "pending", "priority": "high"},
        {"id": "F006-09", "name": "チャットメッセージ送信API (`POST /api/chat`) の実装", "status": "pending", "priority": "high", "notes": "動画の内容に基づいたAI応答を生成。動画ID、現在の動画再生時間、トランスクリプトの関連セグメントをコンテキストとしてAIに渡す。"},
        {"id": "F006-10", "name": "AI応答のリアルタイム表示とチャット履歴の保存", "status": "pending", "priority": "high"},
        {"id": "F006-11", "name": "AIが言及したトランスクリプト箇所へのリンクまたはハイライト機能", "status": "pending", "priority": "medium"},
        {"id": "F006-12", "name": "チャットセッション管理機能 (複数チャットセッションの切り替えなど, オプション)", "status": "pending", "priority": "low"},
        {"id": "F006-13", "name": "キーボードショートカット (再生/一時停止、早送り/巻き戻しなど) (オプション)", "status": "pending", "priority": "low"}
      ]
    },
    {
      "id": "F007",
      "name": "共通UIコンポーネントとスタイリング",
      "description": "Tailwind CSSとUIデザインガイドラインに基づいた、再利用可能なUIコンポーネントと全体的なスタイリング。",
      "status": "pending",
      "priority": "medium",
      "docs": ["docs/ui_design_guidelines.md"],
      "subFeatures": [
        {"id": "F007-01", "name": "グローバルなスタイル定義 (`src/app/globals.css`)", "status": "pending", "priority": "high"},
        {"id": "F007-02", "name": "ヘッダーコンポーネント (ナビゲーション、ユーザー情報、ロゴ)", "status": "pending", "priority": "high"},
        {"id": "F007-03", "name": "フッターコンポーネント (著作権情報など)", "status": "pending", "priority": "low"},
        {"id": "F007-04", "name": "ボタン、入力フィールド、カードなどの汎用UIコンポーネント", "status": "pending", "priority": "high"},
        {"id": "F007-05", "name": "ローディングスピナー/スケルトンUIコンポーネント", "status": "pending", "priority": "medium"},
        {"id": "F007-06", "name": "レスポンシブデザインの実装 (モバイル/タブレット/デスクトップ対応)", "status": "pending", "priority": "high", "notes": "Tailwind CSSのブレークポイントを活用。"},
        {"id": "F007-07", "name": "アクセシビリティ考慮 (ARIA属性など) (オプション)", "status": "pending", "priority": "low"}
      ]
    },
    {
      "id": "F008",
      "name": "エラーハンドリングとUX向上",
      "description": "ユーザーフレンドリーなエラー表示、フォームバリデーション、通知機能など。",
      "status": "pending",
      "priority": "medium",
      "subFeatures": [
        {"id": "F008-01", "name": "APIリクエスト時のエラーハンドリングとユーザーへのフィードバック", "status": "pending", "priority": "high"},
        {"id": "F008-02", "name": "入力フォームのクライアントサイド・サーバーサイドバリデーション", "status": "pending", "priority": "high"},
        {"id": "F008-03", "name": "トースト通知 (例: '動画がインポートされました', 'エラーが発生しました')", "status": "pending", "priority": "medium"},
        {"id": "F008-04", "name": "存在しないページ (`404`) のカスタムエラーページ", "status": "pending", "priority": "medium"},
        {"id": "F008-05", "name": "一般的なエラー (`500`) のカスタムエラーページ", "status": "pending", "priority": "medium"}
      ]
    },
    {
      "id": "F009",
      "name": "型定義とユーティリティ",
      "description": "TypeScriptの型定義と再利用可能なユーティリティ関数の集約。",
      "status": "pending",
      "priority": "medium",
      "subFeatures": [
        {"id": "F009-01", "name": "共通型定義ファイル (`src/types/index.ts`など) の作成", "status": "pending", "priority": "high"},
        {"id": "F009-02", "name": "YouTube APIレスポンスの型定義", "status": "pending", "priority": "high"},
        {"id": "F009-03", "name": "Prismaモデルの型定義 (自動生成されたものを含む)", "status": "pending", "priority": "high"},
        {"id": "F009-04", "name": "日付/時刻フォーマットユーティリティ (`src/lib/date-utils.ts`)", "status": "pending", "priority": "medium"},
        {"id": "F009-05", "name": "URL関連ユーティリティ (`src/lib/url-utils.ts`)", "status": "pending", "priority": "medium"},
        {"id": "F009-06", "name": "トランスクリプト処理ユーティリティ (`src/lib/transcript-utils.ts`) の定義と拡張", "status": "pending", "priority": "high", "notes": "過去の修正経緯から、このファイルのロジックは極めて重要。厳密なテストと仕様遵守を求める。"}
      ]
    }
  ]
}
